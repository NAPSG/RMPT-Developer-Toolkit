// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:builder/plugins/attribute-config/MapProxyItem.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"proxy-check" data-dojo-attach-point\x3d"useProxyCheckBox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"layer-title" title\x3d"${title}"\x3e\r\n    \x3cdiv class\x3d"layer-name"\x3e${title}\x3c/div\x3e\r\n    \x3cdiv class\x3d"access-limit"\x3e\r\n        ${nls.requestLimit}: \x3cspan data-dojo-attach-point\x3d"requestLimitNode"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\r\n        ${nls.interval}: \x3cspan data-dojo-attach-point\x3d"intervalNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"consumeCreditsContent" title\x3d"${nls.consumeCredits}" class\x3d"credits"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"settingBtn" class\x3d"setting" title\x3d"${nls.settings}"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"loading" class\x3d"loading-content"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"setting-dialog hidden" data-dojo-attach-point\x3d"settingDialog" title\x3d""\x3e\r\n    \x3cdiv class\x3d"input-section"\x3e\r\n      \x3cdiv class\x3d"half"\x3e\r\n        \x3cdiv class\x3d"label"\x3e${nls.requestLimit}:\x3c/div\x3e\r\n        \x3cdiv\x3e\r\n          \x3cinput data-dojo-attach-point\x3d"limitSpinner"\r\n            data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n            data-dojo-props\x3d"constraints:{min:0,places:0}"\r\n            value\x3d"0" class\x3d"limit-spinner"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"half"\x3e\r\n        \x3cdiv class\x3d"label"\x3e${nls.interval}:\x3c/div\x3e\r\n        \x3cdiv class\x3d"input"\x3e\r\n          \x3cselect data-dojo-attach-point\x3d"intervalSelect" data-dojo-type\x3d"dijit/form/Select"\r\n            class\x3d"interval-select"\x3e\r\n            \x3coption value\x3d"0"\x3e${nls.none}\x3c/option\x3e\r\n            \x3coption value\x3d"1"\x3e${nls.second}\x3c/option\x3e\r\n            \x3coption value\x3d"60"\x3e${nls.minute}\x3c/option\x3e\r\n            \x3coption value\x3d"3600"\x3e${nls.hour}\x3c/option\x3e\r\n            \x3coption value\x3d"86400"\x3e${nls.day}\x3c/option\x3e\r\n          \x3c/select\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"button-section"\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-btn-vacation jimu-popup-action-btn jimu-float-trailing"\r\n        data-dojo-attach-point\x3d"cancelBtn"\x3e\r\n        ${nls.cancel}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn jimu-popup-action-btn jimu-float-trailing jimu-trailing-margin1"\r\n          data-dojo-attach-point\x3d"okBtn"\x3e\r\n        ${nls.ok}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/Evented dojo/on dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./MapProxyItem.html ./AppProxyUtil jimu/dijit/CheckBox dijit/form/NumberSpinner dijit/form/Select".split(" "),function(d,b,c,g,f,h,k,l,m,n){d=d([h,k,l,g],{baseClass:"map-proxy-item",templateString:m,appProxyManager:null,sourceUrl:"",title:"",useProxy:!1,proxyUrl:"",proxyId:"",premium:!0,consumeCredits:!1,intervalSeconds:0,hitsPerInterval:0,
postMixInProperties:function(){this.inherited(arguments);this.nls=b.mixin(this.nls,window.jimuNls.common);this.nls=b.mixin(this.nls,window.jimuNls.timeUnit)},postCreate:function(){this.inherited(arguments);!0===this.consumeCredits?c.setStyle(this.consumeCreditsContent,"visibility","visible"):c.setStyle(this.consumeCreditsContent,"visibility","hidden");c.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);!0===this.useProxy&&this.proxyId&&this.proxyUrl?this.useProxyCheckBox.setValue(!0):
this.useProxyCheckBox.setValue(!1);isNaN(this.hitsPerInterval)||this.limitSpinner.set("value",this.hitsPerInterval);isNaN(this.intervalSeconds)||this.intervalSelect.set("value",this.intervalSeconds);this._updateLimitLabel();this.own(f(this.useProxyCheckBox,"change",b.hitch(this,this._onUseProxyChange)));this.own(f(this.cancelBtn,"click",b.hitch(this,function(){this._hideDialog()})));this.own(f(this.okBtn,"click",b.hitch(this,function(){this._hideDialog();this._updateProxy()})));this.own(f(document.body,
"click",b.hitch(this,function(a){if(!c.hasClass(this.settingDialog,"hidden")){var e=a.target||a.srcElement,b;a=e===this.settingDialog;b=c.isDescendant(e,this.settingDialog);e=c.isDescendant(e,this.settingBtn);a||b||e||this._hideDialog()}})));this.own(f(this.settingBtn,"click",b.hitch(this,function(){this._toggleDialog()})))},_hideDialog:function(){c.addClass(this.settingDialog,"hidden");c.removeClass(this.settingBtn,"highight")},_showDialog:function(){c.removeClass(this.settingDialog,"hidden");c.addClass(this.settingBtn,
"highight")},_toggleDialog:function(){c.hasClass(this.settingDialog,"hidden")?this._showDialog():this._hideDialog()},_updateLimitLabel:function(){!isNaN(this.hitsPerInterval)&&0<this.hitsPerInterval?this.requestLimitNode.innerHTML=this.hitsPerInterval:this.requestLimitNode.innerHTML=this.nls.unlimit;switch(this.intervalSeconds){case 1:this.intervalNode.innerHTML=this.nls.second;break;case 60:this.intervalNode.innerHTML=this.nls.minute;break;case 3600:this.intervalNode.innerHTML=this.nls.hour;break;
case 86400:this.intervalNode.innerHTML=this.nls.day;break;default:this.intervalNode.innerHTML=this.nls.none}},_updateProxy:function(){var a=this.hitsPerInterval,c=this.intervalSeconds;this.intervalSeconds=+this.intervalSelect.get("value");this.hitsPerInterval=+this.limitSpinner.get("value");this._updateLimitLabel();this.useProxy&&this.appProxyManager&&(a!==this.hitsPerInterval||c!==this.previousIntervalSeconds)&&(this._startProcess("update proxy"),this.appProxyManager.deleteProxies([{proxyId:this.proxyId}]).then(b.hitch(this,
function(){this._createProxy()})).otherwise(b.hitch(this,function(){this._stopProcess()})))},_onUseProxyChange:function(a){a&&!this.proxyId&&this._createProxy();!a&&this.proxyId&&this._deleteProxy()},_createProxy:function(){this._startProcess("Create Proxy");this.intervalSeconds=+this.intervalSelect.get("value");this.hitsPerInterval=+this.limitSpinner.get("value");try{n.createProxy(this.appProxyManager,this.sourceUrl,this.hitsPerInterval,this.intervalSeconds).then(b.hitch(this,function(a){this.proxyUrl=
a.proxyUrl;this.proxyId=a.proxyId;this.useProxy=!0;this.emit("proxyCreated",{sourceUrl:this.sourceUrl,proxyUrl:this.proxyUrl,proxyId:this.proxyId,hitsPerInterval:this.hitsPerInterval,intervalSeconds:this.intervalSeconds,title:this.title,useProxy:!0});this._stopProcess("Create Proxy",!0)})).otherwise(b.hitch(this,function(a){this._createProxiesFail(a)}))}catch(a){this._createProxiesFail(a)}},_createProxiesFail:function(a){this.proxyUrl=this.proxyId="";this.useProxy=!1;this.emit("processError",this.nls.createProxyFailed+
" "+this.sourceUrl);this._stopProcess(a||"Create Proxy",!1)},_deleteProxy:function(){var a=this.proxyId;this.proxyId=this.proxyUrl="";this.useProxy=!1;this.emit("proxyDeleted",{sourceUrl:this.sourceUrl,useProxy:!1});this.useProxyCheckBox.setValue(!1);if(this.appProxyManager)try{this.appProxyManager.deleteProxies([{proxyId:a}])}catch(e){console.error(e)}this._stopProcess("Delete Proxy",!1)},_startProcess:function(a){c.setStyle(this.loading,"display","");this.useProxyCheckBox.setStatus(!1);this.emit("processStart",
a)},_stopProcess:function(a,b){c.setStyle(this.loading,"display","none");this.useProxyCheckBox.setStatus(!0);"undefined"!==typeof b&&this.useProxyCheckBox.setValue(b);this.emit("processEnd",a)}});d.PROXY_CREATED="proxyCreated";d.PROXY_DELETED="proxyDeleted";d.PROCESS_START="processStart";d.PROCESS_END="processEnd";d.PROCESS_ERROR="processError";return d});